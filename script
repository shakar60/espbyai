-- Configuration
local HighlightColor = Color3.fromRGB(255, 0, 0) -- Red color for highlighting
local Transparency = 0.7 -- Transparency of the highlight
local Thickness = 0.1 -- Thickness of the lines

-- Function to create an ESP for a player
local function createPlayerESP(player)
    -- Check if the player has a character and humanoid
    local character = player.Character
    if character and character:FindFirstChildOfClass("Humanoid") then
        local humanoid = character:FindFirstChildOfClass("Humanoid")
        local torso = character:FindFirstChild("UpperTorso") or character:FindFirstChild("Torso")
        local head = character:FindFirstChild("Head")
        local rightHand = character:FindFirstChild("RightHand")
        local leftHand = character:FindFirstChild("LeftHand")
        local rightLeg = character:FindFirstChild("RightFoot")
        local leftLeg = character:FindFirstChild("LeftFoot")

        -- Create lines connecting body parts
        local function createLine(startPart, endPart)
            if startPart and endPart then
                local line = Instance.new("LineHandleAdornment")
                line.Name = "ESP_Line_" .. startPart.Name .. "_" .. endPart.Name
                line.Parent = startPart
                line.Adornee = startPart.Parent
                line.Color3 = HighlightColor
                line.Transparency = Transparency
                line.Thickness = Thickness
                line.ZIndex = 1
                line.CurveSize = 0
                line.Length = (startPart.Position - endPart.Position).magnitude
                line.CFrame = CFrame.new(startPart.Position, endPart.Position) * CFrame.new(0, 0, -line.Length / 2)
            end
        end

        createLine(torso, head)
        createLine(torso, rightHand)
        createLine(torso, leftHand)
        createLine(torso, rightLeg)
        createLine(torso, leftLeg)
    end
end

-- Function to initialize ESP for all existing players
local function initESP()
    for _, player in ipairs(game.Players:GetPlayers()) do
        if player ~= game.Players.LocalPlayer then
            createPlayerESP(player)
        end
    end
end

-- Initialize ESP for existing players
initESP()

-- Connect to player added event to initialize ESP for new players
game.Players.PlayerAdded:Connect(function(player)
    if player ~= game.Players.LocalPlayer then
        createPlayerESP(player)
    end
end)
